<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Nana7ha's Café Stella" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Nana7ha's Café Stella" type="application/atom+xml"><link rel="alternate" type="application/json" title="Nana7ha's Café Stella" href="http://example.com/feed.json"/><link rel="preconnect" href="https://s4.zstatic.net"/><link rel="preconnect" href="https://at.alicdn.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.14"><link rel="modulepreload" href="/js/chunk-3QGRG5LW.js"></link><link rel="modulepreload" href="/js/chunk-7UMIRMHX.js"></link><link rel="modulepreload" href="/js/chunk-MZ54M7VZ.js"></link><link rel="modulepreload" href="/js/copy-tex-VQRK6IHN.js"></link><link rel="modulepreload" href="/js/index.esm-7AJZ7BM6.js"></link><link rel="modulepreload" href="/js/post-3ZAVYNSP.js"></link><link rel="modulepreload" href="/js/quicklink-ONARBQTY.js"></link><link rel="modulepreload" href="/js/siteInit.js"></link><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="s" as="image" fetchpriority="high"><link rel="preload" href=":" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="i" as="image" fetchpriority="high"><link rel="preload" href="n" as="image" fetchpriority="high"><link rel="preload" href="k" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="s" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="v" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="H" as="image" fetchpriority="high"><link rel="preload" href="R" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="H" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="6" as="image" fetchpriority="high"><link rel="preload" href="L" as="image" fetchpriority="high"><link rel="preload" href="y" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="x" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="H" as="image" fetchpriority="high"><link rel="preload" href="J" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="L" as="image" fetchpriority="high"><link rel="preload" href="m" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="z" as="image" fetchpriority="high"><link rel="preload" href="L" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="k" as="image" fetchpriority="high"><link rel="preload" href="v" as="image" fetchpriority="high"><link rel="preload" href="Y" as="image" fetchpriority="high"><link rel="preload" href="y" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="i" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="G" as="image" fetchpriority="high"><link rel="preload" href="U" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="W" as="image" fetchpriority="high"><link rel="preload" href="U" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="j" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="j" as="image" fetchpriority="high"><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="m" as="image" fetchpriority="high"><link rel="preload" href="Y" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="L" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="X" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="Y" as="image" fetchpriority="high"><link rel="preload" href="R" as="image" fetchpriority="high"><link rel="preload" href="D" as="image" fetchpriority="high"><link rel="preload" href="N" as="image" fetchpriority="high"><link rel="preload" href="x" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="N" as="image" fetchpriority="high"><link rel="preload" href="K" as="image" fetchpriority="high"><link rel="preload" href="U" as="image" fetchpriority="high"><link rel="preload" href="G" as="image" fetchpriority="high"><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="Q" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="Y" as="image" fetchpriority="high"><link rel="preload" href="T" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="w" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="J" as="image" fetchpriority="high"><link rel="preload" href="Q" as="image" fetchpriority="high"><link rel="preload" href="k" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="I" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="D" as="image" fetchpriority="high"><link rel="preload" href="F" as="image" fetchpriority="high"><link rel="preload" href="n" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="V" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="k" as="image" fetchpriority="high"><link rel="preload" href="Y" as="image" fetchpriority="high"><link rel="preload" href="X" as="image" fetchpriority="high"><link rel="preload" href="R" as="image" fetchpriority="high"><link rel="preload" href="x" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="D" as="image" fetchpriority="high"><link rel="preload" href="k" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="X" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="_" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="T" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="R" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="Z" as="image" fetchpriority="high"><link rel="preload" href="F" as="image" fetchpriority="high"><link rel="preload" href="M" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="n" as="image" fetchpriority="high"><link rel="preload" href="g" as="image" fetchpriority="high"><meta name="description" content="技术与美日新月异"/><link rel="canonical" href="http://example.com/c-cpp/c-base/%E8%BF%9B%E7%A8%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4/"><title>进程虚拟内存空间</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">进程虚拟内存空间</h1><div class="meta"><span class="item" title="创建时间：2024-07-17 19:29:10"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-07-17T19:29:10+08:00">2024-07-17</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>10k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">七葉の喫茶ステラ</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9iZGU1MWU2MjVlZjhmY2M1L0VhdXpYRDNxMVNKUGhpQ2lVYTAwb19JQkVIb082cDFnc1lZVllkYXRxaDk3X2c_ZT1oRll1ZFM.png" loading="eager" decoding="async" fetchpriority="high" alt="Nana7ha's Café Stella"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/c-cpp/" itemprop="item" rel="index" title="分类于C/C++"><span itemprop="name">C/C++<meta itemprop="position" content="0"/></span></a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/c-cpp/c-basic/" itemprop="item" rel="index" title="分类于C 语言基础"><span itemprop="name">C 语言基础<meta itemprop="position" content="1"/></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/c-cpp/c-base/%E8%BF%9B%E7%A8%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="樱小路七叶"/><meta itemprop="description" content=", 技术与美日新月异"/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Nana7ha's Café Stella"/></span><div class="body md" itemprop="articleBody"><h2 id="进程虚拟内存空间"><a class="anchor" href="#进程虚拟内存空间">#</a> 进程虚拟内存空间</h2>
<h3 id="虚拟内存空间"><a class="anchor" href="#虚拟内存空间">#</a> 虚拟内存空间</h3>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/17/msedge_6lWADXjVKm.png" alt="" /></p>
<p>将 C 程序的内存管理任务完全交给操作系统，虽然听起来是一种简化的方法，但实际上可能会带来一系列问题：</p>
<ol>
<li><strong>进程隔离性</strong>：操作系统需要确保不同进程之间的内存空间相互隔离，以防止一个进程访问或破坏另一个进程的数据。如果 C 程序直接管理物理内存，这种隔离性很难实现，因为程序可能无意中访问到其他进程的内存区域，或者操作系统难以跟踪和限制每个进程的内存访问。</li>
<li><strong>数据安全性</strong>：当程序直接与物理内存交互时，数据的安全性和完整性难以得到保障。恶意程序或错误操作可能会破坏内存中的数据，影响系统的稳定性和可靠性。</li>
<li><strong>内存碎片化</strong>：直接操作物理内存可能导致内存碎片化问题。随着时间的推移，内存的分配和释放可能导致内存块变得零散，难以找到足够大的连续内存区域来满足新的内存请求。这不仅降低了内存的利用率，还可能影响程序的性能。</li>
</ol>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/17/msedge_QRdB0Tx3NR.png" alt="" /></p>
<p><strong>虚拟内存</strong> 是现代操作系统中的一项核心特性，它为每个运行中的进程提供了一个独立的、虚拟的地址空间。这个空间通常被设计为连续的，与物理内存的实际布局无关。</p>
<p>术语 “虚拟” 指的是这些地址空间并不是物理内存的直接映射，而是通过操作系统和内存管理单元（MMU）的协同工作，将虚拟地址转换为物理地址。</p>
<p>当进程开始执行时，它看到的是一个由操作系统为其专门配置的连续虚拟内存空间。这个空间使得进程能够访问到比物理内存更大的内存量，而无需关心物理内存的实际分布。</p>
<p>这种设计极大地简化了内存管理的复杂性，特别是对于程序员而言。程序员编写的 C/C++ 程序所处理的内存，实际上是属于进程自己的虚拟内存。在这个上下文中，所提到的内存地址实际上是虚拟地址，它们由操作系统负责映射到物理内存地址。</p>
<p>实际上虚拟内存空间可以看作是操作系统和物理内存之间的一个抽象层。</p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/17/msedge_T0m93vJQ9N.png" alt="" /></p>
<p>虚拟内存技术为操作系统带来了显著的优势，主要体现在以下几个方面：</p>
<ol>
<li><strong>简化内存管理</strong>：操作系统仅需维护从虚拟地址到物理地址的映射关系，这大大简化了内存的分配和回收机制，提高了内存管理的效率。</li>
<li><strong>提升系统安全性</strong>：每个进程拥有独立的虚拟内存空间，这降低了进程间相互干扰的风险，增强了系统的安全性和稳定性。</li>
<li><strong>灵活的内存使用</strong>：虚拟内存技术允许操作系统采用更灵活的内存管理策略。例如，操作系统可以利用磁盘空间作为虚拟内存，从而支持大型应用程序的运行，即使物理内存有限。</li>
<li><strong>内存复用</strong>：物理内存可以被多个进程共享，但每个进程在自己的虚拟地址空间中看到的是独立的内存区域，从而实现了内存的有效复用。</li>
</ol>
<h3 id="虚拟内存空间模型"><a class="anchor" href="#虚拟内存空间模型">#</a> 虚拟内存空间模型</h3>
<p>虚拟内存空间的组织结构遵循从低地址到高地址的顺序，涵盖了以下几个关键区域：</p>
<ol>
<li><strong>代码段（Code Segment）</strong>：
<ul>
<li>代码段通常位于虚拟内存空间的最低地址处，用于存储程序编译后的可执行指令。这些指令通常被标记为只读，以防止在程序运行时被意外修改。</li>
<li>C 程序员通常不需要直接操作代码段，因为它们在程序编译和加载时就已经确定。</li>
</ul>
</li>
<li><strong>数据段（Data Segment）</strong>：
<ul>
<li>数据段用于存储具有静态存储期限的全局数据，包括全局变量和被  <code>static</code>  关键字修饰的局部变量和全局变量。</li>
<li>此外，数据段还可能包含程序运行时的只读数据，例如字符串字面值。</li>
</ul>
</li>
<li><strong>堆空间（Heap）</strong>：
<ul>
<li>堆空间是 C 程序员最常操作的内存区域，涉及动态内存分配和管理。C 语言的内存管理主要指的是对堆空间的管理。</li>
<li>堆空间的大小可以根据程序的需求动态调整，通常占据虚拟内存空间的大部分。</li>
</ul>
</li>
<li><strong>栈空间（Stack）</strong>：
<ul>
<li>栈空间对于 C 语言的函数调用至关重要，它确保了函数调用的顺序和流程。栈空间遵循 “先进后出” 的原则，随着函数调用从高地址向低地址增长。</li>
<li>栈空间的大小相对有限，通常用于存储局部变量和函数调用的上下文信息。</li>
</ul>
</li>
<li><strong>内核区域（Kernel Space）</strong>：
<ul>
<li>内核区域是操作系统内核专用的内存区域，用于存储内核代码和数据结构。应用程序通常无法直接访问内核空间。</li>
<li>当应用程序进行系统调用时，会从用户态切换到内核态，此时可以访问内核区域。</li>
</ul>
</li>
</ol>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/17/image-20240514103259178.png" alt="image-20240514103259178.png" /></p>
<p>虚拟内存空间通常被划分为两个主要区域，分别是用户区域和内核区域，这两个区域在访问权限和用途上有着明显的区别：</p>
<ol>
<li><strong>用户区域（User Space）</strong>：
<ul>
<li>用户区域是进程可以自由访问和修改的内存区域。它包括了 <strong>代码段、数据段、堆空间和栈空间</strong>，这些区域共同构成了用户进程的地址空间。</li>
<li>用户区域的设计允许进程执行正常的计算任务和数据处理，同时保证了进程之间的隔离，防止一个进程干扰另一个进程的运行。</li>
</ul>
</li>
<li><strong>内核区域（Kernel Space）</strong>：
<ul>
<li>内核区域是操作系统专用的内存区域，用于存放操作系统的核心功能和数据结构。与用户区域不同，普通用户进程无法直接访问内核区域。</li>
<li>内核区域主要用于操作系统与硬件之间的交互，如文件系统操作、I/O 通信、网络通信等。这些操作通常涉及到系统资源的管理和硬件设备的控制。</li>
</ul>
</li>
</ol>
<h2 id="地址和地址值"><a class="anchor" href="#地址和地址值">#</a> 地址和地址值</h2>
<h3 id="内存地址"><a class="anchor" href="#内存地址">#</a> 内存地址</h3>
<p><strong>内存地址</strong> 是计算机系统中用来定位内存中特定位置的数值。在现代计算机架构中，内存地址用于访问存储在随机存取存储器（RAM）中的数据。</p>
<p>内存地址的概念基于这样一个事实：计算机的内存被组织成一个线性的地址空间，每个地址对应一个特定的字节。由于计算机的最小寻址单位通常是一个字节（8 位），因此每个内存地址都指向一个字节大小的内存单元。</p>
<p>可以形象地将虚拟内存空间比作一个巨大的数组，其中每个元素都是一个字节。在这个数组中，每个元素的位置由其在数组中的索引来确定，而在内存中，这个位置就是内存地址。这意味着每个内存地址都唯一地对应于内存中的一个字节，允许 CPU 和操作系统访问和操作存储在该位置的数据。</p>
<h3 id="地址值"><a class="anchor" href="#地址值">#</a> 地址值</h3>
<p>在计算机科学中，&quot;地址&quot; 和 &quot;地址值&quot; 通常指的是内存中特定位置的标识符。地址值的确定取决于系统的位数，即 32 位或 64 位。</p>
<p>当我们在 C 语言中声明一个整型变量  <code>a</code>  并赋予它值 999 时，这个值需要在内存中以二进制形式存储。整数值 999 在内存中的表示取决于计算机的字节序。</p>
<p>整数值 999 的二进制表示是  <code>1111100111</code> （如果我们假设  <code>int</code>  是 8 位的，这实际上是 999 的补码表示）。在 32 位或 64 位系统中， <code>int</code>  类型通常是 32 位的，因此这个值会被扩展到 32 位。如果计算机使用 <strong>小端存储法</strong>（Little-Endian），那么在内存中的存储顺序将是： 低地址 1111100111000000000000000000000000 这意味着最低有效字节（LSB）存储在最低的内存地址上，而最高有效字节（MSB）存储在最高的内存地址上。</p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/17/Qd7fAzk6yM.png" alt="" /></p>
<h4 id="32-位平台"><a class="anchor" href="#32-位平台">#</a> 32 位平台</h4>
<p>在 32 位系统中，虚拟内存空间可以有高达 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">2^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span> 个不同的地址，这相当于 4GB 的内存空间。每个地址都对应一个唯一的内存位置。</p>
<p>例如，如果某个字节的内存地址是： 00000000000000001010101000101100 这个二进制数就是该字节的地址值。</p>
<p>为了提高可读性，地址值通常以十六进制形式表示，例如： 0x0000AA2C 十六进制表示法不仅更简洁，而且更符合程序员的阅读习惯。</p>
<p>对于上述地址的下一个字节，地址值将是： 00000000000000001010101000101101 转换为十六进制表示为： 0x0000AA2D</p>
<h4 id="64-位平台"><a class="anchor" href="#64-位平台">#</a> 64 位平台</h4>
<p><strong>64 位系统架构</strong> 允许计算机访问极大的内存空间。在这种架构中，地址总线有 64 位宽，理论上可以寻址 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup></mrow><annotation encoding="application/x-tex">2^{64}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">64</span></span></span></span></span></span></span></span></span></span></span></span> 个不同的地址，这相当于 16 艾字节（EB）或者说是 1.84 亿太字节（TB）的虚拟地址空间。</p>
<p>尽管理论上存在如此巨大的地址空间，但实际应用中，现代的 64 位硬件和操作系统往往没有充分利用所有这些位。这主要有以下几个原因：</p>
<ol>
<li><strong>硬件限制</strong>：目前的物理内存技术尚未能提供接近  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup></mrow><annotation encoding="application/x-tex">2^{64}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">64</span></span></span></span></span></span></span></span></span></span></span></span>  个地址所需的内存量。</li>
<li><strong>应用需求</strong>：大多数应用程序和操作系统还没有达到需要如此庞大内存空间的需求。</li>
</ol>
<p>因此，现代的 64 位操作系统通常会使用更少的位数来寻址虚拟内存空间。例如，许多系统实际上只使用 48 位来进行寻址，这仍然提供了一个非常大的地址空间，足以满足当前和未来一段时间内的需求。</p>
<h3 id="变量的地址"><a class="anchor" href="#变量的地址">#</a> 变量的地址</h3>
<p>在编程语言如 C 语言中，每个变量在内存中都占有一块特定的空间，而 <strong>变量地址</strong> 指的是这块空间的起始位置，即该空间第一个字节的内存地址。这使得我们可以访问和操作存储在该位置的数据。</p>
<p>以一个 32 位整数变量为例，它在内存中占据 4 个字节。当我们谈论这个变量的地址时，我们指的是这连续 4 个字节的起始地址。在 C 语言中，可以通过取地址运算符  <code>&amp;</code>  来获取变量的地址。例如，如果我们有一个整数变量  <code>a</code> ，表达式  <code>&amp;a</code>  将返回变量  <code>a</code>  在内存中的地址。</p>
<p>重要的是要理解，即使变量可能占据多个字节，变量的地址仍然是指向它在内存中的第一个字节。这有助于我们在使用指针和进行内存操作时，准确地定位和访问数据。</p>
<h3 id="小端存储法"><a class="anchor" href="#小端存储法">#</a> 小端存储法</h3>
<p>在计算机体系结构中，Intel 和 AMD 等主流的 32 位和 64 位处理器通常采用 <strong>小端存储法</strong>（Little-Endian）来存储数据。这种方法将多字节数据的最低有效位（Least Significant Byte, LSB）存储在较低的内存地址上。虽然这种方法可能在直观上不如大端存储法直观，但它在实际应用中广泛使用。</p>
<p>相对地，<strong>大端存储法</strong>（Big-Endian）则将数据的最高有效位（Most Significant Byte, MSB）存储在较低的内存地址上。这种方法在某些情况下更符合人们的直觉，因为它将 “更重要” 的字节放在前面。</p>
<p><strong>大端存储法</strong> 在特定场景下特别有用，尤其是在 <strong>计算机网络</strong> 中传输数据时。网络协议通常要求使用大端存储法来确保数据在不同计算机系统之间传输时的一致性和正确性。这是因为大端存储法在网络协议中被广泛采用，它有助于简化网络通信和数据交换的过程。</p>
<h2 id="缓冲区"><a class="anchor" href="#缓冲区">#</a> 缓冲区</h2>
<h3 id="缓冲区的概念"><a class="anchor" href="#缓冲区的概念">#</a> 缓冲区的概念</h3>
<p><strong>缓冲区定义</strong>：缓冲区是计算机内存中专门分配的一块区域，用于暂存数据。它的主要目的是缓解输入 / 输出（I/O）设备与中央处理器（CPU）及内存之间速度不匹配的问题。</p>
<p><strong>缓冲区的作用</strong>：通过使用缓冲区，系统可以临时存储从慢速设备（如硬盘、网络或用户输入设备）读取的数据，或者待发送到这些设备的数据。这样，CPU 可以继续执行其他任务，而不是等待数据传输完成，从而提高了整体的计算效率。</p>
<p><strong>性能提升</strong>：缓冲区的存在显著提升了 I/O 操作的性能。例如，在读写文件时，数据可以先读入缓冲区，然后 CPU 可以逐步从缓冲区读取数据进行处理，而不是直接与慢速的存储设备交互，这样可以大幅度提高数据处理速度。同样，在与外部设备如键盘和显示器进行交互时，缓冲区也起到了类似的作用，改善了交互速率和用户体验。</p>
<h3 id="执行过程"><a class="anchor" href="#执行过程">#</a> 执行过程</h3>
<p>具体如下（以  <code>printf</code>  和  <code>scanf</code>  为例）：</p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/202310100939887.png" alt="202310100939887.png" /></p>
<ol>
<li><strong>标准输入（stdin）</strong>：
<ul>
<li>stdin 是标准输入流，用于从输入源读取数据。</li>
<li>默认情况下，stdin 的数据来源是键盘。</li>
</ul>
</li>
<li><strong>标准输出（stdout）</strong>：
<ul>
<li>stdout 是标准输出流，用于向输出目的地写入数据。</li>
<li>默认情况下，stdout 的输出目的地是终端显示器。</li>
</ul>
</li>
<li><strong>缓冲区的管理</strong>：
<ul>
<li>C 语言标准库自动管理这些输入输出流资源，程序员可以通过函数调用从 stdin 读取数据，向 stdout 写入数据。</li>
</ul>
</li>
<li><strong>缓冲区的重定向</strong>：
<ul>
<li>程序员可以使用重定向技术改变数据的输入来源和输出目的地。</li>
<li>例如，可以将文件作为输入源，使得 stdin 从文件读取数据。</li>
<li>同时，可以将 stdout 的输出写入到文件或屏幕。</li>
</ul>
</li>
<li><strong>scanf 和 printf 的过程</strong>：
<ul>
<li><code>scanf</code>  函数用于从 stdin 读取数据。</li>
<li><code>printf</code>  函数用于向 stdout 写入数据。</li>
</ul>
</li>
<li><strong>缓冲区的优势</strong>：
<ul>
<li>通过缓冲区，程序员无需考虑数据的具体来源和目的地，可以进行统一处理。</li>
<li>这种设计提高了程序的灵活性和效率。</li>
</ul>
</li>
<li><strong>实际应用</strong>：
<ul>
<li>例如，当 stdin 的数据来源被重定向为文件 a 时，程序会从文件 a 读取数据。</li>
<li>同时，stdout 的输出可以被写入到另一个文件或显示在屏幕上。</li>
</ul>
</li>
</ol>
<h3 id="缓冲区为什么可以提升-io-操作的性能"><a class="anchor" href="#缓冲区为什么可以提升-io-操作的性能">#</a> 缓冲区为什么可以提升 I/O 操作的性能？</h3>
<p><strong>缓冲区提升性能的原理</strong>：缓冲区通过暂存从外部设备流入或流出的数据，减少了 CPU 因等待低速设备数据传输而产生的空闲时间。这种方式允许 CPU 和 I/O 设备并行工作，从而提高了整体的系统效率。</p>
<p><strong>内核区域的作用</strong>：内核区域是操作系统中用于执行底层硬件控制操作的内存区域。它负责管理文件操作、进程和线程的资源管理、网络通信等关键任务。在这个区域内，操作系统和硬件紧密协作，以确保数据能够高效地在外部设备和内核区域之间传输。</p>
<p><strong>系统调用的机制</strong>：用户进程不能直接访问内核区域。为了获取内核区域中的数据，用户进程必须通过系统调用来请求操作系统内核的服务。系统调用提供了一种安全的方式来访问受保护的资源，并执行需要高权限的操作。</p>
<p><strong>性能考虑</strong>：系统调用涉及到用户态和内核态之间的切换，这是一个资源密集型的过程。因此，为了优化性能，应当尽量减少系统调用的次数。通过使用缓冲区和其他技术，可以减少对系统调用的依赖，从而提升系统的整体性能。</p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/msedge_6fVMWgJ9kz.png" alt="" /></p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/msedge_JcSgTpkLUb.png" alt="" /></p>
<p>缓冲区通过减少 I/O 操作过程中的系统调用次数，显著提高了整体的 I/O 性能。系统调用是昂贵的操作，因为它们涉及到用户态和内核态之间的切换。通过使用缓冲区，数据可以先存储在缓冲区中，然后一次性地进行系统调用，从而减少了频繁切换的需要。</p>
<p>缓冲区充当了一种防错机制，即使程序员对 I/O 操作的内部机制不够了解，也可以通过缓冲区保证操作的性能达到一定的标准。这种机制降低了因编程错误导致性能问题的风险。</p>
<p>虽然缓冲区带来了性能上的提升，但它也存在一些缺点。缓冲区需要占用额外的内存空间，这可能会在内存资源有限的情况下成为一个问题。此外，缓冲区可能会引入数据传输的延迟，因为数据需要先写入缓冲区，然后再从缓冲区写入最终目的地。</p>
<h3 id="缓冲区刷新机制"><a class="anchor" href="#缓冲区刷新机制">#</a> 缓冲区刷新机制</h3>
<p>缓冲区通常具备自动刷新的能力，这是一种在满足特定条件时触发数据传输的机制。这种机制对于管理数据流动和优化性能至关重要。</p>
<ol>
<li><strong>输入缓冲区</strong>：对于输入缓冲区，通常不需要考虑刷新问题。当输入缓冲区中有数据时，可以读取；当数据被读取完毕后，输入缓冲区为空，进一步的读取操作将不会获得更多数据。</li>
<li><strong>输出缓冲区</strong>：与输入缓冲区不同，输出缓冲区需要刷新机制。如果输出缓冲区的数据不被刷新（即写入目的地），它们将一直保留在缓冲区中，导致数据无法正确输出。</li>
<li><strong>缓冲区类型</strong>：
<ul>
<li><strong>全缓冲区</strong>：当缓冲区满时，会自动刷新，常见于文件缓冲区。</li>
<li><strong>行缓冲区</strong>：当缓冲区遇到换行符时，会自动刷新，如标准输出  <code>stdout</code>  的缓冲区。</li>
<li><strong>不缓冲</strong>：数据一旦写入，立即刷新，不保留任何数据，如标准错误  <code>stderr</code>  的缓冲区。</li>
</ul>
</li>
<li><strong>注意事项</strong>：
<ul>
<li>缓冲区满时会自动刷新。</li>
<li>程序结束时，标准流的缓冲区也会自动刷新，但不应依赖此机制。</li>
<li>缓冲区刷新的具体行为可能因编译器和平台而异。</li>
<li>可以使用  <code>fflush</code>  函数手动刷新  <code>stdout</code>  和文件流的缓冲区，但对于  <code>stdin</code>  输入缓冲区的刷新，C 标准并未定义其行为，因此这种操作是未定义的，不应依赖此操作来清空输入缓冲区。</li>
</ul>
</li>
</ol>
<h2 id="栈区"><a class="anchor" href="#栈区">#</a> 栈区</h2>
<h3 id="栈帧"><a class="anchor" href="#栈帧">#</a> 栈帧</h3>
<p>在 C 语言程序中，函数调用会经历一系列的内存管理操作，这些操作与栈帧的概念密切相关：</p>
<ol>
<li><strong>栈帧的创建</strong>：每次调用函数时，系统会在栈上为该函数分配一个内存区域，称为 “栈帧”。每个栈帧都是独立的，包含了该函数的局部变量、参数、返回地址等信息。</li>
<li><strong>局部变量的作用域</strong>：由于不同函数的栈帧相互独立，局部变量仅在创建它们的函数内部有效。这意味着局部变量的生命周期与函数的执行期间一致。</li>
<li><strong>函数调用的过程</strong>：当一个函数被调用时，其栈帧被 “压入”（push）栈中，这个过程称为 “入栈”。此时，局部变量开始分配空间并生效。</li>
<li><strong>函数调用结束</strong>：当函数执行完毕，其栈帧被 “弹出”（pop）栈中，这个过程称为 “出栈”。随着栈帧的销毁，局部变量的生命周期结束，它们所占用的内存空间被释放。</li>
<li><strong>自动存储期</strong>：在 C 语言中，局部变量的这种生命周期被称为 “自动存储期”，因为它们的创建和销毁是自动管理的，不需要程序员显式操作。</li>
</ol>
<p>虽然虚拟内存空间中的栈采用了与数据结构栈相同的原则，但它们在实现上可能有所不同。虚拟内存空间的栈是由操作系统和编译器共同管理的，而数据结构栈通常是由程序员在程序中显式实现的。</p>
<p>对于以下函数：</p>
<figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>入栈顺序为  <code>main -&gt; test -&gt; test2</code> ，出栈顺序则相反。</p>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/202401021347007.png" alt="202401021347007.png" /></p>
<p>栈的 “先进后出”（LIFO）特性对程序的执行流程有着决定性的影响。这意味着在程序中，先被调用的函数将在后被调用的函数之后结束执行。这种特性确保了程序在函数调用时的顺序性和内存管理的有效性。</p>
<p>在 C 语言程序中， <code>main</code>  函数是程序的入口点，它最先被调用。根据栈的特性， <code>main</code>  函数也将是最后结束的函数。当  <code>main</code>  函数执行完毕并返回时，它标志着整个程序的执行结束，进程随之结束。</p>
<p>虚拟内存空间中的栈区域对于程序的执行至关重要。它不仅负责存储局部变量和函数调用的上下文信息，还决定了函数调用的顺序。每次函数调用时，新的栈帧被压入栈顶；函数执行完毕后，其栈帧被弹出，释放内存空间。这一过程确保了程序能够按照预定的顺序执行，并且有效地管理内存资源。</p>
<h3 id="栈区域内存管理的特点"><a class="anchor" href="#栈区域内存管理的特点">#</a> 栈区域内存管理的特点</h3>
<p><strong>栈内存管理的特点</strong>：栈区域的内存管理以其简单性和高效性而著称。这种管理机制由操作系统和编译器共同协作完成，确保了函数调用和局部变量的生命周期得到正确管理。</p>
<p>在栈的内存管理中，一个关键的组件是栈顶指针（Stack Pointer）。这个指针始终指向当前栈帧的顶部，即当前正在执行的函数的栈帧。当一个函数被调用时，一个新的栈帧被创建并压入栈顶；当函数返回时，该栈帧被弹出，栈顶指针相应地向下移动。</p>
<p>栈顶指针所标记的当前栈帧包含了当前函数的局部变量、参数、返回地址等信息。这个栈帧代表了当前正在执行的函数的执行上下文，是程序执行流程中不可或缺的部分。</p>
<h3 id="函数调用和栈帧管理"><a class="anchor" href="#函数调用和栈帧管理">#</a> 函数调用和栈帧管理</h3>
<h4 id="入栈"><a class="anchor" href="#入栈">#</a> 入栈</h4>
<p>当一个函数被调用时，会发生一系列的内存管理操作，这些操作涉及到栈帧的创建和销毁。在 C 语言中，这些操作通常由编译器和操作系统共同完成。</p>
<ol>
<li><strong>栈帧进栈</strong>：当函数被调用时，一个新的栈帧（Stack Frame）被创建并压入栈顶。这个过程涉及到为函数的局部变量、参数和返回地址分配内存空间。</li>
<li><strong>SP 指针的变化</strong>：栈指针（Stack Pointer，通常表示为 SP）在函数调用时会减少，以腾出空间来存储新的栈帧。减少的量等于新调用函数栈帧的大小。</li>
<li><strong>栈帧的组成</strong>：每个栈帧包含了函数的局部变量、函数参数、返回地址等信息。这些信息在函数执行期间是活跃的，并在函数返回时被销毁。</li>
<li><strong>函数返回</strong>：当函数执行完毕并准备返回时，它的栈帧从栈中弹出，SP 指针相应地增加，恢复到函数调用前的值。这个过程释放了函数的局部变量所占用的内存空间。</li>
</ol>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/202311082026062.png" alt="202311082026062.png" /></p>
<h4 id="出栈"><a class="anchor" href="#出栈">#</a> 出栈</h4>
<ol>
<li><strong>函数返回</strong>：当一个函数完成其执行并准备返回时，它会通过 <code>return</code>  语句将控制权交还给调用者。</li>
<li><strong>出栈过程</strong>：随着函数的返回，之前为该函数创建的栈帧需要从栈中移除，这个过程称为 “出栈”。</li>
<li><strong>SP 寄存器指针</strong>：栈指针（Stack Pointer，通常表示为 SP）在函数出栈时会增加。增加的量等于该函数栈帧的大小，这样 SP 指针就会指向新的栈顶。</li>
<li><strong>恢复状态</strong>：出栈过程还会恢复调用者的栈帧状态，包括局部变量、参数和返回地址等。这样，调用者可以继续从函数调用前的状态执行。</li>
</ol>
<p><img loading="lazy" data-src="https://image.cwlrin.wiki/images/2024/07/20/202311082026358.png" alt="202311082026358.png" /></p>
<h3 id="栈区域内存管理的优点和缺点"><a class="anchor" href="#栈区域内存管理的优点和缺点">#</a> 栈区域内存管理的优点和缺点</h3>
<p>优点：</p>
<ol>
<li><strong>简单高效</strong>：栈内存的分配和释放过程非常直接和快速。当一个函数被调用时，它的局部变量和栈帧被自动压入栈中；当函数返回时，这些内容被自动弹出，无需程序员手动管理。</li>
<li><strong>自动内存管理</strong>：使用栈内存时，程序员不需要担心内存泄漏或内存释放的问题，因为栈的内存管理是自动的。</li>
<li><strong>线程安全</strong>：每个线程都有自己的栈，这意味着局部变量是线程隔离的，避免了多线程环境下的数据竞争和同步问题。</li>
</ol>
<p>缺点：</p>
<ol>
<li><strong>栈空间有限</strong>：由于栈空间通常较小，它不适合存储大型数据结构，如大数组或大字符串。</li>
<li><strong>缺乏动态性</strong>：在编译时，栈帧的大小就已经确定，这意味着栈上的数据结构不能在运行时动态调整大小。</li>
<li><strong>数据无法共享</strong>：由于栈是线程隔离的，栈上的数据不能在不同线程之间共享，这在需要跨线程数据交互的场景中可能是一个缺点。</li>
</ol>
</div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2024-12-17 19:30:14" itemprop="dateModified" datetime="2024-12-17T19:30:14+08:00">2024-12-17</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>樱小路七叶<i class="ic i-at"><em>@</em></i>Nana7ha's Café Stella</li><li class="link"><strong>本文链接：</strong><a href="http://example.com/c-cpp/c-base/%E8%BF%9B%E7%A8%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4/" title="进程虚拟内存空间">http://example.com/c-cpp/c-base/进程虚拟内存空间/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/misc/Doxygen-%E8%AF%AD%E6%B3%95%E7%AE%80%E4%BB%8B/" rel="prev" itemprop="url" title="Doxygen 语法简介" style="background-image: linear-gradient(to bottom right, #cdb8b2, #e2eaff);"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>杂项</span><h3>Doxygen 语法简介</h3></a></div><div class="item right"><a href="/misc/log4cpp-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" rel="next" itemprop="url" title="log4cpp 简单使用" style="background-image: linear-gradient(to bottom right, #bbfcaa, #d7d1bc);"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>杂项</span><h3>log4cpp 简单使用</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4"><span class="toc-number">1.</span> <span class="toc-text"> 进程虚拟内存空间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4"><span class="toc-number">1.1.</span> <span class="toc-text"> 虚拟内存空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text"> 虚拟内存空间模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%92%8C%E5%9C%B0%E5%9D%80%E5%80%BC"><span class="toc-number">2.</span> <span class="toc-text"> 地址和地址值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80"><span class="toc-number">2.1.</span> <span class="toc-text"> 内存地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%80%BC"><span class="toc-number">2.2.</span> <span class="toc-text"> 地址值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#32-%E4%BD%8D%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 32 位平台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#64-%E4%BD%8D%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text"> 64 位平台</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-number">2.3.</span> <span class="toc-text"> 变量的地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%AB%AF%E5%AD%98%E5%82%A8%E6%B3%95"><span class="toc-number">2.4.</span> <span class="toc-text"> 小端存储法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">3.</span> <span class="toc-text"> 缓冲区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">3.1.</span> <span class="toc-text"> 缓冲区的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.2.</span> <span class="toc-text"> 执行过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E6%8F%90%E5%8D%87-io-%E6%93%8D%E4%BD%9C%E7%9A%84%E6%80%A7%E8%83%BD"><span class="toc-number">3.3.</span> <span class="toc-text"> 缓冲区为什么可以提升 I&#x2F;O 操作的性能？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E5%88%B7%E6%96%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">3.4.</span> <span class="toc-text"> 缓冲区刷新机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%88%E5%8C%BA"><span class="toc-number">4.</span> <span class="toc-text"> 栈区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E5%B8%A7"><span class="toc-number">4.1.</span> <span class="toc-text"> 栈帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E5%8C%BA%E5%9F%9F%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">4.2.</span> <span class="toc-text"> 栈区域内存管理的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%92%8C%E6%A0%88%E5%B8%A7%E7%AE%A1%E7%90%86"><span class="toc-number">4.3.</span> <span class="toc-text"> 函数调用和栈帧管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A5%E6%A0%88"><span class="toc-number">4.3.1.</span> <span class="toc-text"> 入栈</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E6%A0%88"><span class="toc-number">4.3.2.</span> <span class="toc-text"> 出栈</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E5%8C%BA%E5%9F%9F%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E7%BC%BA%E7%82%B9"><span class="toc-number">4.4.</span> <span class="toc-text"> 栈区域内存管理的优点和缺点</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" rel="bookmark" title="C 语言数据类型">C 语言数据类型</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E8%AF%AD%E5%8F%A5/" rel="bookmark" title="C 语言语句">C 语言语句</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0/" rel="bookmark" title="C 语言函数">C 语言函数</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E5%A4%B4%E6%96%87%E4%BB%B6/" rel="bookmark" title="C 语言头文件">C 语言头文件</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E7%BB%84/" rel="bookmark" title="C 语言数组">C 语言数组</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="bookmark" title="C 语言字符串">C 语言字符串</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E7%BB%93%E6%9E%84%E4%BD%93/" rel="bookmark" title="C 语言结构体">C 语言结构体</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%8C%87%E9%92%88/" rel="bookmark" title="C语言指针">C语言指针</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E9%93%BE%E8%A1%A8/" rel="bookmark" title="C 语言数据结构——链表">C 语言数据结构——链表</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E6%A0%88/" rel="bookmark" title="C 语言数据结构——栈">C 语言数据结构——栈</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E9%98%9F%E5%88%97/" rel="bookmark" title="C 语言数据结构——队列">C 语言数据结构——队列</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E5%93%88%E5%B8%8C%E8%A1%A8/" rel="bookmark" title="C 语言数据结构——哈希表">C 语言数据结构——哈希表</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" rel="bookmark" title="C 语言数据结构——二叉搜索树">C 语言数据结构——二叉搜索树</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%8E%92%E5%BA%8F/" rel="bookmark" title="C 语言排序">C 语言排序</a></li><li ><a href="/c-cpp/c-base/C%20%E8%AF%AD%E8%A8%80%E6%96%87%E4%BB%B6%E6%B5%81/" rel="bookmark" title="C 语言文件流">C 语言文件流</a></li><li  class="active"><a href="/c-cpp/c-base/%E8%BF%9B%E7%A8%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4/" rel="bookmark" title="进程虚拟内存空间">进程虚拟内存空间</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="樱小路七叶" src="/assets/avatar.jpg"/><p class="name" itemprop="name">樱小路七叶</p><div class="description" itemprop="description">技术与美日新月异</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">97</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">15</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/cwlrin" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;cwlrin"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/ying-xiao-lu-qi-ye" class="item zhihu" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;ying-xiao-lu-qi-ye"><i class="ic i-zhihu"></i></a><a target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=411590211" class="item music" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;411590211"><i class="ic i-cloud-music"></i></a><a target="_blank" rel="noopener" href="https://space.bilibili.com/8013992" class="item bilibili" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;8013992"><i class="ic i-bilibili"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于本站</a></li><li class="item"><a href="/admiration/" rel="section"><i class="ic i-coffee"></i>赞赏博主</a></li></ul></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/misc/log4cpp-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/misc/Doxygen-%E8%AF%AD%E6%B3%95%E7%AE%80%E4%BB%8B/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2020 -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">樱小路七叶 @ 七葉の喫茶ステラ</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">1.5m 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">22:31</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `c-cpp/c-base/进程虚拟内存空间/`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.14" type="module" fetchpriority="high" defer></script></body></html>